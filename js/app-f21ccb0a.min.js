!function(t){var e={};function r(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(o,i,function(e){return t[e]}.bind(null,i));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=5)}([function(t,e){t.exports='<div class=wrap> <div class=top> <img class=preview /> <div class=btns> <div class="btn img"> <span>更换图片</span> <input type=file accept=.jpg,.jpge,.png /> </div> <span class="btn level">一级难度</span> <span class="btn reset">重新开始</span> </div> </div> </div> '},function(t,e,r){var o=r(2),i=r(3);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[t.i,i,""]]);var n={insert:"head",singleton:!1},a=(o(i,n),i.locals?i.locals:{});t.exports=a},function(t,e,r){"use strict";var o,i=function(){return void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o},n=function(){var t={};return function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}t[e]=r}return t[e]}}(),a=[];function s(t){for(var e=-1,r=0;r<a.length;r++)if(a[r].identifier===t){e=r;break}return e}function c(t,e){for(var r={},o=[],i=0;i<t.length;i++){var n=t[i],c=e.base?n[0]+e.base:n[0],l=r[c]||0,h="".concat(c," ").concat(l);r[c]=l+1;var u=s(h),f={css:n[1],media:n[2],sourceMap:n[3]};-1!==u?(a[u].references++,a[u].updater(f)):a.push({identifier:h,updater:b(f,e),references:1}),o.push(h)}return o}function l(t){var e=document.createElement("style"),o=t.attributes||{};if(void 0===o.nonce){var i=r.nc;i&&(o.nonce=i)}if(Object.keys(o).forEach((function(t){e.setAttribute(t,o[t])})),"function"==typeof t.insert)t.insert(e);else{var a=n(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}return e}var h,u=(h=[],function(t,e){return h[t]=e,h.filter(Boolean).join("\n")});function f(t,e,r,o){var i=r?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(t.styleSheet)t.styleSheet.cssText=u(e,i);else{var n=document.createTextNode(i),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(n,a[e]):t.appendChild(n)}}function p(t,e,r){var o=r.css,i=r.media,n=r.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),n&&btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),t.styleSheet)t.styleSheet.cssText=o;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(o))}}var d=null,w=0;function b(t,e){var r,o,i;if(e.singleton){var n=w++;r=d||(d=l(e)),o=f.bind(null,r,n,!1),i=f.bind(null,r,n,!0)}else r=l(e),o=p.bind(null,r,e),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(r)};return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else i()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=i());var r=c(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var o=0;o<r.length;o++){var i=s(r[o]);a[i].references--}for(var n=c(t,e),l=0;l<r.length;l++){var h=s(r[l]);0===a[h].references&&(a[h].updater(),a.splice(h,1))}r=n}}}},function(t,e,r){(t.exports=r(4)(!1)).push([t.i,".wrap{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-align:center;align-items:center}.wrap .top{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;width:308px;height:160px}.wrap .preview{box-sizing:border-box;max-width:160px;max-height:160px;border:4px solid #fff}.wrap .btns{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;justify-content:space-around;height:160px}.wrap .btn{position:relative;box-sizing:border-box;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;width:110px;height:36px;font-size:16px;color:#fff;background:#6aae78;border:2px solid #fff;border-radius:18px;-webkit-tap-highlight-color:transparent;-webkit-transition:all 0.1s;transition:all 0.1s}.wrap .btn.reset{background:#e6a153}.wrap .btn:active{-webkit-transform:scale(1.1);transform:scale(1.1)}.wrap input{position:absolute;width:100%;height:100%;opacity:0}\n",""])},function(t,e,r){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=function(t,e){var r=t[1]||"",o=t[3];if(!o)return r;if(e&&"function"==typeof btoa){var i=(a=o,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),n=o.sources.map((function(t){return"/*# sourceURL="+o.sourceRoot+t+" */"}));return[r].concat(n).concat([i]).join("\n")}var a;return[r].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+r+"}":r})).join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var o={},i=0;i<this.length;i++){var n=this[i][0];null!=n&&(o[n]=!0)}for(i=0;i<t.length;i++){var a=t[i];null!=a[0]&&o[a[0]]||(r&&!a[2]?a[2]=r:r&&(a[2]="("+a[2]+") and ("+r+")"),e.push(a))}},e}},function(t,e,r){"use strict";function o(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}r.r(e);var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=e.width,o=e.height,i=e.row,n=e.col;this.width=r,this.height=o,this.row=i,this.col=n,this.$el=document.createElement("div"),this.render()}var e,r,i;return e=t,(r=[{key:"render",value:function(){var t=this.$el,e=this.width,r=this.height,o=this.row,i=this.col,n=e/i,a=r/o;Object.assign(t.style,{position:"relative",display:"table",zIndex:1,pointerEvents:"none"});for(var s=0;s<o;s++){var c=document.createElement("div");Object.assign(c.style,{display:"table-row"});for(var l=0;l<i;l++){var h=document.createElement("div");Object.assign(h.style,{display:"table-cell",width:n+"px",height:a+"px",boxSizing:"border-box"}),0!==l&&Object.assign(h.style,{borderLeft:"1px solid #fff"}),0!==s&&Object.assign(h.style,{borderTop:"1px solid #fff"}),c.appendChild(h)}t.appendChild(c)}}}])&&o(e.prototype,r),i&&o(e,i),t}();function n(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.arrow={left:void 0,top:void 0,right:void 0,bottom:void 0}}var e,r,o;return e=t,(r=[{key:"setArrow",value:function(t){var e=t.left,r=t.right,o=t.top,i=t.bottom;this.arrow={left:e,right:r,top:o,bottom:i}}}])&&n(e.prototype,r),o&&n(e,o),t}();function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=function(t){function e(){return c(this,e),l(this,h(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(e,t),e}(a),p="ontouchstart"in document,d=p?"touchstart":"click",w={mousedown:p?"touchstart":"mousedown",mousemove:p?"touchmove":"mousemove",mouseup:p?"touchend":"mouseup"};function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function m(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var x=function(t){function e(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=m(this,v(e).call(this));var o=t.sourcePos,i=t.width,n=t.height,a=t.img,s=t.imgWidth,c=t.imgHeight,l=t.parent;return r.sourcePos=o,r.nowPos=[],r.img=a,r.imgWidth=s,r.imgHeight=c,r.width=i,r.height=n,r.parent=l,r.$el=document.createElement("canvas"),r.render(),r.bindEvent(),r}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(e,t),r=e,(o=[{key:"render",value:function(){var t=this.$el,e=this.img,r=this.sourcePos,o=this.imgWidth,i=this.imgHeight,n=this.width,a=this.height,s=t.getContext("2d");t.className="block",t.width=n*devicePixelRatio,t.height=a*devicePixelRatio,s.drawImage(e,r[0]*o,r[1]*i,o,i,0,0,t.width,t.height)}},{key:"setPos",value:function(t,e){this.nowPos=[t,e],Object.assign(this.$el.style,{position:"absolute",left:this.nowPos[0]*this.width+"px",top:this.nowPos[1]*this.height+"px",width:this.width+"px",height:this.height+"px"})}},{key:"bindEvent",value:function(){var t=this,e=this.$el;e.addEventListener(w.mousedown,(function(r){r.preventDefault();var o=e.offsetLeft,i=e.offsetTop,n=r.pageX||r.touches[0].pageX,a=r.pageY||r.touches[0].pageY,s=n,c=a,l=function(r){var n=r.pageX||r.touches[0].pageX,a=r.pageY||r.touches[0].pageY,l=n-s,h=a-c,u=o,p=i;t.arrow.left instanceof f&&l<0?u=o+Math.max(l,-t.width):t.arrow.right instanceof f&&l>0?u=o+Math.min(l,t.width):t.arrow.top instanceof f&&h<0?p=i+Math.max(h,-t.height):t.arrow.bottom instanceof f&&h>0&&(p=i+Math.min(h,t.height)),Object.assign(e.style,{left:u+"px",top:p+"px"})};document.addEventListener(w.mousemove,l),document.addEventListener(w.mouseup,(function r(n){var a=n.pageX||n.changedTouches[0].pageX,h=n.pageY||n.changedTouches[0].pageY,u=a-s,p=h-c,d=o,b=i;t.arrow.left instanceof f&&u<0?(d=o-t.width,t.setAllArrow("left")):t.arrow.right instanceof f&&u>0?(d=o+t.width,t.setAllArrow("right")):t.arrow.top instanceof f&&p<0?(b=i-t.height,t.setAllArrow("top")):t.arrow.bottom instanceof f&&p>0&&(b=i+t.height,t.setAllArrow("bottom")),Object.assign(e.style,{left:d+"px",top:b+"px"}),d===o&&b===i||t.parent.isSuccess(),document.removeEventListener(w.mousemove,l),document.removeEventListener(w.mouseup,r)}))}))}},{key:"setAllArrow",value:function(t){var e=null,r=this.arrow.left,o=this.arrow.right,i=this.arrow.top,n=this.arrow.bottom;"left"===t||"right"===t?("left"===t?((e=this.arrow.left).arrow.left&&(e.arrow.left.arrow.right=this),this.arrow.right&&(this.arrow.right.arrow.left=e),this.arrow.left=e.arrow.left,this.arrow.right=e,e.arrow.left=this,e.arrow.right=o,this.nowPos[0]--):((e=this.arrow.right).arrow.right&&(e.arrow.right.arrow.left=this),this.arrow.left&&(this.arrow.left.arrow.right=e),this.arrow.left=e,this.arrow.right=e.arrow.right,e.arrow.left=r,e.arrow.right=this,this.nowPos[0]++),e.arrow.top&&(e.arrow.top.arrow.bottom=this),e.arrow.bottom&&(e.arrow.bottom.arrow.top=this),this.arrow.top&&(this.arrow.top.arrow.bottom=e),this.arrow.bottom&&(this.arrow.bottom.arrow.top=e),this.arrow.top=e.arrow.top,this.arrow.bottom=e.arrow.bottom,e.arrow.top=i,e.arrow.bottom=n):("top"===t?((e=this.arrow.top).arrow.top&&(e.arrow.top.arrow.bottom=this),this.arrow.bottom&&(this.arrow.bottom.arrow.top=e),this.arrow.top=e.arrow.top,this.arrow.bottom=e,e.arrow.top=this,e.arrow.bottom=n,this.nowPos[1]--):((e=this.arrow.bottom).arrow.bottom&&(e.arrow.bottom.arrow.top=this),this.arrow.top&&(this.arrow.top.arrow.bottom=e),this.arrow.bottom=e.arrow.bottom,this.arrow.top=e,e.arrow.bottom=this,e.arrow.top=i,this.nowPos[1]++),e.arrow.left&&(e.arrow.left.arrow.right=this),e.arrow.right&&(e.arrow.right.arrow.left=this),this.arrow.left&&(this.arrow.left.arrow.right=e),this.arrow.right&&(this.arrow.right.arrow.left=e),this.arrow.left=e.arrow.left,this.arrow.right=e.arrow.right,e.arrow.left=r,e.arrow.right=o)}}])&&g(r.prototype,o),i&&g(r,i),e}(a);function k(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var j=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=e.img,o=e.width,i=e.height,n=e.row,a=e.col;this.img=r,this.width=o,this.height=i,this.row=n,this.col=a,this.$el=document.createElement("div"),this.blocks=[],this.board=null,this.render(),this.renderBlocks(),this.resetBlocks(),this.renderBoard()}var e,r,o;return e=t,(r=[{key:"render",value:function(){Object.assign(this.$el.style,{position:"relative",width:this.width+"px",height:this.height+"px",marginTop:"30px",background:"#756780",border:"4px solid #fff"})}},{key:"renderBoard",value:function(){var t={width:this.width,height:this.height,row:this.row,col:this.col};this.board=new i(t),this.$el.appendChild(this.board.$el)}},{key:"renderBlocks",value:function(){for(var t=this.width,e=this.height,r=this.row,o=this.col,i=this.img,n=this.blocks,a=this.$el,s=t/o,c=e/r,l=i.width/o,h=i.height/r,u=0;u<r;u++)for(var p=0;p<o&&(u!==this.row-1||p!==this.col-1);p++){var d=new x({sourcePos:[p,u],width:s,height:c,img:i,imgWidth:l,imgHeight:h,parent:this});n.push(d),a.appendChild(d.$el)}n.push(new f)}},{key:"isSuccess",value:function(){var t=!0;this.blocks.forEach((function(e){e instanceof x&&(e.sourcePos[0]!==e.nowPos[0]||e.sourcePos[1]!==e.nowPos[1])&&(t=!1)})),t&&setTimeout((function(){alert("挑战成功")}),300)}},{key:"resetBlocks",value:function(){for(var t=this.blocks.slice(0,-1).sort((function(){return Math.random()>.5?1:-1})),e=[],r=0;r<this.row;r++){for(var o=[],i=0;i<this.col;i++){if(r===this.row-1&&i===this.col-1){o.push(this.blocks[this.blocks.length-1]);break}var n=t[0];n.setPos(i,r),o.push(n),t.shift()}e.push(o)}e.forEach((function(t,r){t.forEach((function(o,i){var n={left:t[i-1],right:t[i+1],top:(e[r-1]||[])[i],bottom:(e[r+1]||[])[i]};o.setArrow(n)}))}))}},{key:"setSize",value:function(){var t=this.img.width/this.img.height,e=300,r=300;t>1?r=e/t:e=r*t,this.width=e,this.height=r}},{key:"changeImage",value:function(t){this.img=t,this.setSize(),this.render(),this.clearBlocks(),this.renderBlocks(),this.resetBlocks(),this.clearBoard(),this.renderBoard()}},{key:"changeLevel",value:function(t,e){this.row=t,this.col=e,this.clearBlocks(),this.renderBlocks(),this.resetBlocks(),this.clearBoard(),this.renderBoard()}},{key:"clearBlocks",value:function(){var t=this;this.blocks.forEach((function(e){e instanceof x&&t.$el.removeChild(e.$el)})),this.blocks=[]}},{key:"clearBoard",value:function(){this.board&&this.$el.removeChild(this.board.$el),this.board=null}}])&&k(e.prototype,r),o&&k(e,o),t}(),O=(r(1),r(0)),P=r.n(O);function S(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var E="https://i.loli.net/2020/02/08/8xtsWhDvRqUK57Y.jpg",T=document.querySelector(".app"),C={3:"一级难度",4:"二级难度",5:"三级难度"},_=Object.keys(C),M=3,A=new Image;A.onload=function(){var t={img:this,width:300,height:300,row:M,col:M},e=window.pingTu=new j(t);T.innerHTML=P.a;var r=T.querySelector(".wrap"),o=T.querySelector(".preview"),i=T.querySelector(".img"),n=T.querySelector("input"),a=T.querySelector(".level"),s=T.querySelector(".reset");r.appendChild(e.$el),o.src=E,n.addEventListener("change",(function(t){!function(t,e,r){var o=new FileReader;o.onload=function(t){var o=t.target.result,i=new Image;i.onload=function(){e.changeImage(this)},i.src=o,r.src=o},o.readAsDataURL(t)}(t.target.files[0],e,o)})),i.addEventListener(d,(function(t){t.stopPropagation()})),a.addEventListener(d,(function(t){t.stopPropagation(),setTimeout((function(){!function(t,e){++M>Math.max.apply(Math,S(_))&&(M=Math.min.apply(Math,S(_)));t.changeLevel(M,M),e.innerText=C[M]}(e,a)}),100)})),s.addEventListener(d,(function(t){t.stopPropagation(),e.resetBlocks()}))},A.src=E}]);