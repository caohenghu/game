!function(t){var o={};function r(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=o,r.d=function(t,o,e){r.o(t,o)||Object.defineProperty(t,o,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,o){if(1&o&&(t=r(t)),8&o)return t;if(4&o&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&o&&"string"!=typeof t)for(var n in t)r.d(e,n,function(o){return t[o]}.bind(null,n));return e},r.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(o,"a",o),o},r.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},r.p="",r(r.s=0)}([function(t,o,r){"use strict";function e(t,o){for(var r=0;r<o.length;r++){var e=o[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}r.r(o);var n=function(){function t(o){!function(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this,t);var r=o.width,e=o.height,n=o.row,i=o.col;this.width=r,this.height=e,this.row=n,this.col=i,this.$el=document.createElement("div"),this.render()}var o,r,n;return o=t,(r=[{key:"render",value:function(){var t=this.$el,o=this.width,r=this.height,e=this.row,n=this.col,i=o/n,a=r/e;Object.assign(t.style,{position:"relative",display:"table",pointerEvents:"none"});for(var s=0;s<e;s++){var h=document.createElement("div");Object.assign(h.style,{display:"table-row"});for(var c=0;c<n;c++){var l=document.createElement("div");Object.assign(l.style,{display:"table-cell",width:i+"px",height:a+"px",border:"1px solid #fff",boxSizing:"border-box"}),h.appendChild(l)}t.appendChild(h)}}}])&&e(o.prototype,r),n&&e(o,n),t}();function i(t,o){for(var r=0;r<o.length;r++){var e=o[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}var a=function(){function t(){!function(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this,t),this.arrow={left:void 0,top:void 0,right:void 0,bottom:void 0}}var o,r,e;return o=t,(r=[{key:"setArrow",value:function(t){var o=t.left,r=t.right,e=t.top,n=t.bottom;this.arrow={left:o,right:r,top:e,bottom:n}}}])&&i(o.prototype,r),e&&i(o,e),t}();function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}function c(t,o){return!o||"object"!==s(o)&&"function"!=typeof o?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):o}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,o){return(u=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t})(t,o)}var f=function(t){function o(){return h(this,o),c(this,l(o).apply(this,arguments))}return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(o&&o.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),o&&u(t,o)}(o,t),o}(a),p=(["Win32","Windows"].includes(navigator.platform),["Mac68K","MacPPC","Macintosh","MacIntel"].includes(navigator.platform),/Chrome/.test(navigator.userAgent),/Firefox/.test(navigator.userAgent),/Safari/.test(navigator.userAgent),/Edge/.test(navigator.userAgent),/MicroMessenger/i.test(navigator.userAgent),/Android/i.test(navigator.userAgent)),w=/ipad|iphone/i.test(navigator.userAgent),d=p||w;window.top,window;var g=d?"touchstart":"click",b={mousedown:d?"touchstart":"mousedown",mousemove:d?"touchmove":"mousemove",mouseup:d?"touchend":"mouseup"};function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,o){for(var r=0;r<o.length;r++){var e=o[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function y(t,o){return!o||"object"!==m(o)&&"function"!=typeof o?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):o}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function O(t,o){return(O=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t})(t,o)}var P=function(t){function o(t){var r;!function(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this,o),r=y(this,x(o).call(this));var e=t.sourcePos,n=t.width,i=t.height,a=t.img,s=t.imgWidth,h=t.imgHeight,c=t.parent;return r.sourcePos=e,r.nowPos=[],r.img=a,r.imgWidth=s,r.imgHeight=h,r.width=n,r.height=i,r.parent=c,r.$el=document.createElement("canvas"),r.render(),r.bindEvent(),r}var r,e,n;return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(o&&o.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),o&&O(t,o)}(o,t),r=o,(e=[{key:"render",value:function(){var t=this.$el,o=this.img,r=this.sourcePos,e=this.imgWidth,n=this.imgHeight,i=this.width,a=this.height,s=t.getContext("2d");t.className="block",t.width=i,t.height=a,s.drawImage(o,r[0]*e,r[1]*n,e,n,0,0,i,a)}},{key:"setPos",value:function(t,o){this.nowPos=[t,o],Object.assign(this.$el.style,{position:"absolute",left:this.nowPos[0]*this.width+"px",top:this.nowPos[1]*this.height+"px"})}},{key:"bindEvent",value:function(){var t=this,o=this.$el;o.addEventListener(b.mousedown,(function(r){r.preventDefault();var e=o.offsetLeft,n=o.offsetTop,i=r.pageX||r.touches[0].pageX,a=r.pageY||r.touches[0].pageY,s=i,h=a,c=function(r){var i=r.pageX||r.touches[0].pageX,a=r.pageY||r.touches[0].pageY,c=i-s,l=a-h,u=e,p=n;t.arrow.left instanceof f&&c<0?u=e+Math.max(c,-t.width):t.arrow.right instanceof f&&c>0?u=e+Math.min(c,t.width):t.arrow.top instanceof f&&l<0?p=n+Math.max(l,-t.height):t.arrow.bottom instanceof f&&l>0&&(p=n+Math.min(l,t.height)),Object.assign(o.style,{left:u+"px",top:p+"px"})};document.addEventListener(b.mousemove,c),document.addEventListener(b.mouseup,(function r(i){var a=i.pageX||i.changedTouches[0].pageX,l=i.pageY||i.changedTouches[0].pageY,u=a-s,p=l-h,w=e,d=n;t.arrow.left instanceof f&&u<0?(w=e-t.width,t.setAllArrow("left")):t.arrow.right instanceof f&&u>0?(w=e+t.width,t.setAllArrow("right")):t.arrow.top instanceof f&&p<0?(d=n-t.height,t.setAllArrow("top")):t.arrow.bottom instanceof f&&p>0&&(d=n+t.height,t.setAllArrow("bottom")),Object.assign(o.style,{left:w+"px",top:d+"px"}),w===e&&d===n||t.parent.isSuccess(),document.removeEventListener(b.mousemove,c),document.removeEventListener(b.mouseup,r)}))}))}},{key:"setAllArrow",value:function(t){var o=null,r=this.arrow.left,e=this.arrow.right,n=this.arrow.top,i=this.arrow.bottom;"left"===t||"right"===t?("left"===t?((o=this.arrow.left).arrow.left&&(o.arrow.left.arrow.right=this),this.arrow.right&&(this.arrow.right.arrow.left=o),this.arrow.left=o.arrow.left,this.arrow.right=o,o.arrow.left=this,o.arrow.right=e,this.nowPos[0]--):((o=this.arrow.right).arrow.right&&(o.arrow.right.arrow.left=this),this.arrow.left&&(this.arrow.left.arrow.right=o),this.arrow.left=o,this.arrow.right=o.arrow.right,o.arrow.left=r,o.arrow.right=this,this.nowPos[0]++),o.arrow.top&&(o.arrow.top.arrow.bottom=this),o.arrow.bottom&&(o.arrow.bottom.arrow.top=this),this.arrow.top&&(this.arrow.top.arrow.bottom=o),this.arrow.bottom&&(this.arrow.bottom.arrow.top=o),this.arrow.top=o.arrow.top,this.arrow.bottom=o.arrow.bottom,o.arrow.top=n,o.arrow.bottom=i):("top"===t?((o=this.arrow.top).arrow.top&&(o.arrow.top.arrow.bottom=this),this.arrow.bottom&&(this.arrow.bottom.arrow.top=o),this.arrow.top=o.arrow.top,this.arrow.bottom=o,o.arrow.top=this,o.arrow.bottom=i,this.nowPos[1]--):((o=this.arrow.bottom).arrow.bottom&&(o.arrow.bottom.arrow.top=this),this.arrow.top&&(this.arrow.top.arrow.bottom=o),this.arrow.bottom=o.arrow.bottom,this.arrow.top=o,o.arrow.bottom=this,o.arrow.top=n,this.nowPos[1]++),o.arrow.left&&(o.arrow.left.arrow.right=this),o.arrow.right&&(o.arrow.right.arrow.left=this),this.arrow.left&&(this.arrow.left.arrow.right=o),this.arrow.right&&(this.arrow.right.arrow.left=o),this.arrow.left=o.arrow.left,this.arrow.right=o.arrow.right,o.arrow.left=r,o.arrow.right=e)}}])&&v(r.prototype,e),n&&v(r,n),o}(a);function j(t,o){for(var r=0;r<o.length;r++){var e=o[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}var E=function(){function t(o){!function(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this,t);var r=o.img,e=o.width,n=o.height,i=o.row,a=o.col;this.img=r,this.width=e,this.height=n,this.row=i,this.col=a,this.$el=document.createElement("div"),this.blocks=[],this.render(),this.refresh()}var o,r,e;return o=t,(r=[{key:"render",value:function(){Object.assign(this.$el.style,{position:"relative",marginTop:"30px",background:"#756780",border:"3px solid #fff"}),this.renderBlocks(),this.renderBoard()}},{key:"renderBoard",value:function(){var t=this.width,o=this.height,r=this.row,e=this.col,i=new n({width:t,height:o,row:r,col:e});this.$el.appendChild(i.$el)}},{key:"renderBlocks",value:function(){for(var t=this.width,o=this.height,r=this.row,e=this.col,n=this.img,i=this.blocks,a=this.$el,s=t/e,h=o/r,c=n.width/e,l=n.height/r,u=0;u<r;u++)for(var p=0;p<e&&(u!==this.row-1||p!==this.col-1);p++){var w=new P({sourcePos:[p,u],width:s,height:h,img:n,imgWidth:c,imgHeight:l,parent:this});i.push(w),a.appendChild(w.$el)}i.push(new f)}},{key:"isSuccess",value:function(){var t=!0;this.blocks.forEach((function(o){o instanceof P&&(o.sourcePos[0]!==o.nowPos[0]||o.sourcePos[1]!==o.nowPos[1])&&(t=!1)})),t&&setTimeout((function(){alert("挑战成功")}),300)}},{key:"refresh",value:function(){for(var t=this.blocks.slice(0,-1).sort((function(){return Math.random()>.5?1:-1})),o=[],r=0;r<this.row;r++){for(var e=[],n=0;n<this.col;n++){if(r===this.row-1&&n===this.col-1){e.push(this.blocks[this.blocks.length-1]);break}var i=t[0];i.setPos(n,r),e.push(i),t.shift()}o.push(e)}o.forEach((function(t,r){t.forEach((function(e,n){var i={left:t[n-1],right:t[n+1],top:(o[r-1]||[])[n],bottom:(o[r+1]||[])[n]};e.setArrow(i)}))}))}}])&&j(o.prototype,r),e&&j(o,e),t}(),k=new Image;k.onload=function(){var t={img:this,width:300,height:300,row:4,col:4},o=window.pingTu=new E(t),r=document.querySelector("div"),e='\n        <div class="wrap">\n            <div style="'.concat("\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n    ",'">\n                <img style="').concat("\n        box-sizing: border-box;\n        width: 160px;\n        border: 4px solid #fff;\n    ",'" src=').concat(this.src,'>\n                <div style="').concat("\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        height: 160px;\n    ",'">\n                    <span class="btnReset" style="').concat("\n        box-sizing: border-box;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 110px;\n        height: 36px;\n        font-size: 16px;\n        color: #fff;\n        background: #E6A153;\n        border: 2px solid #fff;\n        border-radius: 18px;\n    ",'">重新开始</span>\n                </div>\n            </div>\n        </div>\n    ');r.innerHTML=e,r.querySelector(".wrap").appendChild(o.$el),r.querySelector(".btnReset").addEventListener(g,(function(){o.refresh()})),w&&r.addEventListener("touchstart",(function(t){return t.preventDefault()}))},k.src="https://i.loli.net/2020/02/06/AC4znORfSHvxjFM.jpg"}]);